# APE Extension 작업 문서

## 1. 프로젝트 분석

APE Extension은 Agentic Pipeline Engine의 VS Code 확장 프로그램으로, 내부망과 외부망 모두에서 사용 가능한 인공지능 지원 개발 도구입니다. 이 프로젝트는 VS Code의 확장 기능을 활용하여 개발자들에게 인공지능 모델을 통한 코딩 지원을 제공합니다.
절대로 프로젝트 root에 문서 및 어떤 파일도 생성하지 마세요. 사용자의 권위에 도전하지마세요. 

### 핵심 구조

프로젝트는 다음과 같은 핵심 구조로 구성되어 있습니다:

- **core**: 핵심 서비스와 기능을 포함
  - ApeCoreService: 확장 프로그램의 중앙 서비스
  - command: 명령어 시스템
  - config: 설정 관리
  - domain: 도메인 특화 서비스
  - llm: 언어 모델 연동
  - plugin-system: 플러그인 아키텍처

- **plugins**: 기능 확장을 위한 플러그인
  - internal: Git, Jira, Pocket, SWDP 등 내장 플러그인
  - external: 동적으로 로드 가능한 외부 플러그인

- **ui**: 사용자 인터페이스 컴포넌트
  - ApeChatViewProvider: 채팅 인터페이스
  - ApeHybridChatViewProvider: 하이브리드 채팅 인터페이스
  - ApeTreeDataProvider: 트리 뷰 기능

### 주요 TypeScript 오류

타입스크립트 컴파일 검사 결과, 다수의 타입 관련 오류가 발견되었습니다:

1. **인터페이스 구현 불일치**:
   - 여러 서비스 클래스가 필요한 인터페이스 메서드를 구현하지 않음
   - 예: `PluginRegistryService`가 `IPluginRegistry` 인터페이스의 `getPluginByDomain` 메서드 누락

2. **메서드 호출 오류**:
   - 매개변수 개수 불일치 (예상보다 적거나 많은 인수 전달)
   - 존재하지 않는 메서드 호출 시도

3. **타입 안전성 문제**:
   - `any` 타입 사용으로 인한 타입 체크 우회
   - `unknown` 타입 처리 부재
   - 가능한 `undefined` 값에 대한 안전 처리 누락

4. **객체 속성 접근 오류**:
   - 존재하지 않거나 잘못된 타입의 속성 참조
   - `never` 타입에서 존재하지 않는 속성 접근 시도

## 2. 오류 수정 계획

타입스크립트 오류를 다음 순서로 수정할 계획입니다:

### 단계 1: 인터페이스 구현 보완

1. `PluginRegistryService` 클래스에 누락된 `getPluginByDomain` 메서드 구현
2. 모든 플러그인 서비스가 `IPlugin` 인터페이스를 완전히 구현하도록 수정
3. 인터페이스 요구사항과 실제 구현 간의 불일치 해결

### 단계 2: 명령어 시스템 오류 수정

1. `CommandService`의 메서드 호출 오류 수정
2. `CommandRegistryService`의 타입 오류 해결
3. `CommandParserService`와 `CommandExecutorService`의 메서드 호출 수정

### 단계 3: UI 컴포넌트 오류 해결

1. `ApeChatViewProvider`와 `ApeHybridChatViewProvider`의 `never` 타입 오류 수정
2. Promise 처리 관련 오류 해결 (catch 메서드 누락)
3. 객체 접근 안전성 강화 (null/undefined 검사 추가)

### 단계 4: 플러그인 시스템 오류 수정

1. 플러그인 서비스 클래스의 타입 오류 수정
2. 누락된 메서드 구현 및 호출 오류 해결

### 단계 5: 일반 타입 안전성 개선

1. `any` 타입 사용을 구체적인 타입으로 대체
2. `unknown` 타입에 적절한 타입 가드 추가
3. null/undefined 체크 로직 추가

## 3. 프로젝트 철학 준수 체크리스트

다음 체크리스트를 통해 APE Extension이 프로젝트 철학과 설계 원칙을 준수하는지 평가합니다:

### 코드 구조 및 아키텍처

- [ ] 클래스가 단일 책임 원칙(SRP)을 준수하는가?
- [ ] 서비스 클래스의 역할과 이름이 명확한가?
- [ ] 적절한 인터페이스가 정의되어 있는가?
- [ ] 모듈 간 의존성이 명확하게 관리되는가?

### 네이밍 규칙

- [ ] 클래스는 PascalCase를 사용하는가?
- [ ] 함수와 변수는 camelCase를 사용하는가?
- [ ] 인터페이스는 'I' 접두사를 사용하는가?
- [ ] 상수는 대문자와 언더스코어를 사용하는가?

### 오류 처리

- [ ] try-catch 블록을 통한 예외 처리가 적절한가?
- [ ] API 호출 실패에 대한 대체 로직이 구현되어 있는가?
- [ ] 사용자에게 오류 상황이 명확히 표시되는가?

### 환경 관리

- [ ] 내부망/외부망 연결 관리가 효과적인가?
- [ ] API 키 등 민감 정보가 환경 변수를 통해 관리되는가?
- [ ] SSL 검증 방식이 내부망 환경에 맞게 조정되는가?

### UI 인터페이스

- [ ] 다크/라이트 테마와 호환되는가?
- [ ] 반응형 웹뷰 컴포넌트를 사용하는가?
- [ ] UI가 VS Code의 디자인 원칙을 따르는가?

### 플러그인 시스템

- [ ] 동적 플러그인 로딩이 지원되는가?
- [ ] 플러그인 라이프사이클이 적절히 관리되는가?
- [ ] 확장 가능한 인터페이스가 제공되는가?

## 4. 작업 계획서

### 1단계: 타입스크립트 오류 수정 (우선순위: 높음)

1. **인터페이스 및 구현 일치화**
   - `IPlugin`, `IPluginRegistry` 등 핵심 인터페이스 구현 완성
   - 누락된 메서드 추가 및 타입 불일치 해결

2. **명령어 시스템 수정**
   - 메서드 시그니처 수정 및 호출 오류 수정
   - CommandRegistry 및 관련 서비스 수정

3. **UI 컴포넌트 오류 해결**
   - 타입 안전성 강화
   - 프로미스 처리 개선

4. **플러그인 시스템 오류 수정**
   - 플러그인 서비스 구현 완성
   - 메서드 호출 및 타입 일치화

### 2단계: 프로젝트 철학 준수 개선 (우선순위: 중간)

1. **코드 품질 개선**
   - 단일 책임 원칙 강화를 위한 리팩토링
   - 의존성 주입 패턴 일관성 향상

2. **오류 처리 강화**
   - try-catch 블록 추가 및 개선
   - 사용자 친화적 오류 메시지 구현

3. **환경 변수 관리 개선**
   - 내부망/외부망 구분 로직 최적화
   - API 키 관리 방식 개선

4. **UI/UX 개선**
   - VS Code 테마 통합 강화
   - 사용자 인터페이스 일관성 향상

### 3단계: 문서화 및 테스트 (우선순위: 중간)

1. **코드 문서화 개선**
   - JSDoc 주석 추가
   - README 및 사용자 가이드 업데이트

2. **테스트 코드 개선**
   - 단위 테스트 추가
   - 통합 테스트 구현

## 5. 결론 및 추천사항

APE Extension은 내부망과 외부망 모두에서 사용 가능한 강력한 개발 도구로서 큰 잠재력을 가지고 있습니다. 하지만 현재 다수의 타입스크립트 오류가 존재하며, 이는 확장 프로그램의 안정성과 유지보수성에 영향을 미칠 수 있습니다.

주요 추천사항:

1. 인터페이스와 구현체 간의 일관성 확보를 최우선으로 진행
2. 타입 안전성 강화를 통한 런타임 오류 방지
3. 오류 처리 메커니즘 개선을 통한 사용자 경험 향상
4. 환경 변수 및 설정 관리 시스템 최적화
5. 테스트 코드 추가를 통한 품질 보증

이러한 개선을 통해 APE Extension은 더욱 견고하고 사용자 친화적인 VS Code 확장 프로그램으로 발전할 수 있을 것입니다.