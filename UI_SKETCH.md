# APE Extension - UI 및 트리뷰 구조 스케치

## 전체 인터페이스 구조

```
+-------------------------------------------+
|                   VS Code                  |
+-------+-----------------------------------+
|       |                                   |
|       |                                   |
|  APE  |           채팅 인터페이스          |
|  트리  |                                   |
|  뷰   |                                   |
|       |                                   |
|       |                                   |
+-------+-----------------------------------+
```

## 트리뷰 구조

```
APE
├── 🤖 채팅 (활성)
│   ├── OpenRouter/Claude
│   ├── OpenAI/GPT-4
│   └── Custom API
│
├── 📚 세션 히스토리
│   ├── 2024-05-05
│   │   ├── Git 기능 개발 논의
│   │   └── API 연동 테스트
│   └── 2024-05-04
│       └── 초기 요구사항 정의
│
├── 📝 Vault
│   ├── 프로젝트 A
│   │   ├── 요구사항.md
│   │   └── API_스펙.md
│   └── 공용 지식
│       ├── Git_활용법.md
│       └── LLM_프롬프트_가이드.md
│
└── 📋 Rules
    ├── 시스템 룰
    │   ├── ✓ 기본 프롬프트.md (활성)
    │   └── 디버그 모드.md
    └── 프로젝트 룰
        ├── ✓ 코드 리뷰.md (활성)
        └── API 문서화.md
```

## 주요 UI 요소

### 1. 트리뷰 상단 작업 표시줄
```
+---------------------------+
| APE                 + 🔄 |
+---------------------------+
```
- `+` : 새 항목 추가 (컨텍스트에 따라 세션/Vault 파일/Rule 생성)
- `🔄` : 새로고침

### 2. 항목별 컨텍스트 메뉴

#### 채팅 메뉴
```
+---------------------------+
| 새 채팅                    |
| 모델 변경                  |
| 설정                      |
+---------------------------+
```

#### 세션 히스토리 메뉴
```
+---------------------------+
| 열기                      |
| Vault에 저장              |
| 이름 변경                  |
| 삭제                      |
+---------------------------+
```

#### Vault 메뉴
```
+---------------------------+
| 새 파일                    |
| 새 폴더                    |
| Reveal in Explorer        |
| 이름 변경                  |
| 삭제                      |
+---------------------------+
```

#### Rules 메뉴
```
+---------------------------+
| 새 Rule                   |
| 활성화/비활성화             |
| 편집                      |
| Reveal in Explorer        |
| 삭제                      |
+---------------------------+
```

### 3. 채팅 인터페이스

```
+-------------------------------------------+
|                                           |
|  +---------------------------------------+  |
|  | System: 채팅이 초기화되었습니다.         |  |
|  +---------------------------------------+  |
|                                           |
|  +---------------------------------------+  |
|  | User: Git 명령어는 어떻게 사용하나요?    |  |
|  +---------------------------------------+  |
|                                           |
|  +---------------------------------------+  |
|  | Assistant: Git은 분산 버전 관리...      |  |
|  |                                       |  |
|  | ```bash                               |  |
|  | git init                              |  |
|  | git add .                             |  |
|  | git commit -m "Initial commit"        |  |
|  | ```                                   |  |
|  +---------------------------------------+  |
|                                           |
|  +---------------------------------------+  |
|  | [메시지 입력...]             ▶ 📋 ⚙️ |  |
|  +---------------------------------------+  |
|                                           |
+-------------------------------------------+
```

#### 채팅 컨트롤
- `▶` : 전송 버튼
- `📋` : Vault에 저장
- `⚙️` : 채팅 설정 (모델 변경, 토큰 제한 등)

### 4. Rules 활성화 표시

활성화된 룰은 트리뷰에서 체크마크(✓)로 표시됩니다. 사용자는 컨텍스트 메뉴를 통해 룰을 활성화하거나 비활성화할 수 있습니다.

## 인터랙션 흐름

### 1. 새 채팅 세션 시작
```
사용자 → 트리뷰 '채팅' 노드 우클릭 → '새 채팅' 선택 → 새 채팅 인터페이스 표시
```

### 2. 세션 히스토리 열기
```
사용자 → 트리뷰에서 히스토리 항목 선택 → 해당 채팅 세션 로드
```

### 3. Vault 파일 관리
```
사용자 → 트리뷰 'Vault' 노드 우클릭 → '새 파일' 선택 → 파일명 입력 → VS Code 에디터에서 파일 열림
```

### 4. Rules 활성화
```
사용자 → 트리뷰 'Rules' 항목 우클릭 → '활성화' 선택 → 체크마크로 활성 상태 표시 → 이후 채팅에 해당 룰 적용
```

### 5. 채팅 내용 Vault에 저장
```
사용자 → 채팅 인터페이스 하단 '📋' 버튼 클릭 → 저장 대화상자 표시 → 위치 및 파일명 선택 → Vault에 저장
```

## 미니멀 디자인 원칙

1. **불필요한 컨트롤 제거**: 꼭 필요한 컨트롤만 표시
2. **VS Code 스타일 준수**: VS Code의 디자인 언어와 일관성 유지
3. **단일 스크롤**: 중첩 스크롤 방지를 위한 단일 스크롤 컨테이너 구조
4. **반응형 레이아웃**: 패널 크기 변경에 적응하는 레이아웃
5. **키보드 접근성**: 모든 기능을 키보드로도 사용 가능하도록 설계

## 구현 기술

- VS Code TreeView API 및 FileSystemProvider API
- Webview API (채팅 인터페이스)
- React 또는 기본 웹 컴포넌트 (Webview 내부)
- CSS Grid 및 Flexbox (반응형 레이아웃)