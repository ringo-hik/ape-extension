# APE 하이브리드 인터페이스 설계 및 구현 계획

## 개요

APE(Agentic Pipeline Engine)는 온프레미스 환경에 최적화된 도메인 중심 AI 어시스턴트 서비스입니다. 본 문서는 자연어 상호작용과 명령어 기반 도구 사용을 하이브리드 방식으로 통합하는 인터페이스 설계 및 구현 계획을 제시합니다.

## 1. 디자인 원칙

1. **AI 우선, 도구 자연스럽게**: 기본적으로 AI 어시스턴트 인터페이스를 유지하면서 도구 기능을 자연스럽게 발견할 수 있도록 함
2. **컨텍스트 인식**: 사용자의 작업 컨텍스트에 맞는 도구와 제안을 동적으로 표시
3. **점진적 학습**: 직관적 인터페이스로 시작해 명령어를 자연스럽게 학습하도록 유도
4. **도메인 최적화**: 온프레미스 환경에서 주로 사용하는 핵심 도메인(Git, Jira, Pocket)에 집중

## 2. UI/UX 핵심 요소

### 2.1 채팅 인터페이스

```
+------------------------------------------+
| APE 채팅                                 |
+------------------------------------------+
|                                          |
| APE: 안녕하세요! APE입니다. 코딩 질문이나|
| Git, Jira, 저장소 관리를 도와드릴 수     |
| 있습니다.                                |
|                                          |
| [Git 시작] [Jira 시작] [저장소 관리]     |
|                                          |
| 사용자: 작업 중인 파일에 무슨 변경사항이 |
| 있어?                                    |
|                                          |
| APE: 현재 3개 파일이 수정되었습니다:     |
| - src/main.js                            |
| - README.md                              |
| - package.json                           |
|                                          |
| [변경 내용 보기] [커밋하기] [이력 확인]  |
|                                          |
+------------------------------------------+
| [🔧][📊][🔍] 무엇을 도와드릴까요?  [⏎]  |
+------------------------------------------+
```

### 2.2 도구 접근 수단

1. **컨텍스트 버튼**: AI 응답 아래 표시되는 관련 액션 버튼
2. **하단 도구 바**: 입력 필드 왼쪽의 도메인 아이콘
3. **슬래시 명령어**: `/` 입력 시 자동완성되는 구조화된 명령어
4. **자연어 입력**: 어떤 형태로든 자유롭게 입력 가능한 기본 인터페이스

### 2.3 명령어 형식 통합

- 슬래시(`/`) 접두사를 표준으로 채택
- 도메인:명령어 형식 유지 (예: `/git:status`, `/jira:issue`)
- 자연어를 자동으로 적절한 명령어로 변환하는 지능형 인텐트 인식

## 3. 기술 아키텍처

### 3.1 시스템 구성도

```
+--------------------+     +--------------------+     +--------------------+
|                    |     |                    |     |                    |
|  VS Code 웹뷰 UI   | <-> |  APE 코어 서비스   | <-> |  도메인 플러그인   |
|                    |     |                    |     |                    |
+--------------------+     +--------------------+     +--------------------+
         |                        |                          |
         v                        v                          v
+--------------------+     +--------------------+     +--------------------+
|                    |     |                    |     |                    |
|   UI 컴포넌트      |     |   인텐트 인식      |     |   명령어 처리      |
|                    |     |                    |     |                    |
+--------------------+     +--------------------+     +--------------------+
```

### 3.2 핵심 컴포넌트

#### 3.2.1 통합 인텐트 인식 시스템

```typescript
interface CommandIntent {
  domain: string;         // 'git', 'jira', 'pocket', 'general'
  command: string;        // 'status', 'commit', 'issue', etc.
  args: string[];         // 명령어 인자 배열
  originalInput: string;  // 원본 사용자 입력
  confidence: number;     // 인식 신뢰도 (0-1)
}

class UnifiedIntentRecognizer {
  // 도메인별 인식기 및 LLM 통합
}
```

#### 3.2.2 명령어 실행 파이프라인

```typescript
class CommandExecutor {
  // 명령어 실행 및 결과 포맷팅
}
```

#### 3.2.3 UI 렌더링 엔진

```typescript
class ChatRenderer {
  // 메시지, 버튼, 상호작용 요소 렌더링
}
```

#### 3.2.4 컨텍스트 관리자

```typescript
class ContextManager {
  // VS Code 에디터 컨텍스트 및 사용자 상호작용 컨텍스트 관리
}
```

## 4. 구현 로드맵

### 단계 1: 기반 시스템 구축 (1-2주)

1. **웹뷰 인터페이스 기본 구조**
   - 채팅 UI 컴포넌트 구현
   - 메시지 렌더링 시스템
   - 기본 입력 처리

2. **통합 인텐트 인식 시스템**
   - 슬래시 명령어 파서
   - 패턴 기반 인식기
   - LLM 연동 인식 (고급)

3. **명령어 실행 파이프라인**
   - 도메인 플러그인 인터페이스 정의
   - 명령어 결과 표준화

### 단계 2: 도메인 통합 및 상호작용 개선 (2-3주)

1. **핵심 도메인 통합**
   - Git 명령어 및 버튼 구현
   - Jira 통합 및 인터페이스
   - Pocket 스토리지 관리 기능

2. **컨텍스트 인식 제안 시스템**
   - 에디터 컨텍스트 분석
   - 사용자 행동 패턴 추적
   - 동적 명령어 제안

3. **점진적 학습 지원**
   - 명령어 가이드 및 힌트
   - 자동완성 및 제안 개선
   - 명령어 히스토리 및 학습

### 단계 3: 고급 기능 및 최적화 (3-4주)

1. **고급 자연어 상호작용**
   - 복합 명령어 이해 및 실행
   - 대화 컨텍스트 유지 및 참조 해결
   - 멀티스텝 작업 자동화

2. **성능 최적화**
   - LLM 호출 최적화 및 캐싱
   - UI 응답성 개선
   - 지연 로딩 및 백그라운드 처리

3. **사용자 경험 개선**
   - 테마 및 시각적 일관성
   - 키보드 단축키 및 접근성
   - 오류 처리 및 피드백

## 5. 기술적 과제 및 해결 방안

### 5.1 LLM 활용 최적화

**과제**: LLM 호출은 지연 시간과 비용이 발생할 수 있음

**해결 방안**:
- 로컬 패턴 매칭 우선 사용, LLM은 모호한 경우에만 활용
- 공통 패턴 및 결과 캐싱
- 백그라운드 분석 및 미리 준비

### 5.2 사용자 학습 곡선

**과제**: 자연어와 명령어 간 전환이 자연스러워야 함

**해결 방안**:
- 버튼 클릭 시 실제 실행된 명령어 표시
- 점진적으로 명령어 구문 소개
- 개인화된 사용 패턴 학습

### 5.3 VS Code 확장 제약

**과제**: VS Code 웹뷰는 제한된 UI 기능을 제공

**해결 방안**:
- CSS 및 자바스크립트 최적화
- 리액트 또는 경량 UI 프레임워크 활용
- VS Code API 활용 최대화

## 6. 사용자 시나리오

### 시나리오 1: 초보 사용자

```
사용자: (APE 처음 사용)

APE: 안녕하세요! APE입니다. 코딩 질문에 답하거나, Git 관리, Jira 이슈 처리, 
저장소 관리 등을 도와드릴 수 있습니다.

[Git 시작하기] [Jira 시작하기] [저장소 관리] [도움말]

사용자: 이 프로젝트에 어떤 기능들이 있는지 알려줘

APE: 현재 프로젝트는 Node.js 기반 웹 애플리케이션입니다. 주요 기능:
- 사용자 인증 (로그인/회원가입)
- 데이터 시각화 대시보드
- REST API 엔드포인트
- 데이터베이스 연동 (MongoDB)

더 자세한 정보가 필요하신가요?

[코드 구조 분석] [의존성 확인] [API 목록 보기]

사용자: [코드 구조 분석 클릭]

APE: [명령어 실행: /analyze:structure]
프로젝트 구조 분석 중...

...
```

### 시나리오 2: 복합 작업 수행

```
사용자: Jira 이슈 PROJ-123을 위한 새 브랜치를 만들고 작업 시작하고 싶어

APE: Jira 이슈 PROJ-123을 위한 작업을 시작하겠습니다. 다음 단계를 제안합니다:

1. 이슈 PROJ-123 상세 정보 확인
2. 이슈 관련 브랜치 생성
3. 작업 시작 (이슈 상태 변경)

어떤 작업부터 진행할까요?

[모든 단계 자동 실행] [이슈 확인] [브랜치 생성] [작업 시작]

사용자: [모든 단계 자동 실행 클릭]

APE: 모든 단계를 자동으로 실행합니다.

1. 이슈 PROJ-123 정보:
   제목: 로그인 페이지 UI 개선
   담당자: 미할당
   상태: To Do
   
2. 브랜치 생성:
   ✅ 브랜치 'feature/PROJ-123-login-ui'가 생성되었습니다.
   
3. 이슈 상태 변경:
   ✅ PROJ-123 이슈가 'In Progress' 상태로 변경되었습니다.
   
모든 작업이 완료되었습니다. 이제 'feature/PROJ-123-login-ui' 브랜치에서 
작업을 시작할 수 있습니다.

[변경 내용 확인] [코드 열기] [이슈 세부정보 보기]
```

## 7. 평가 및 피드백 계획

### 7.1 사용성 평가 지표

- 명령어 성공률: 사용자 의도가 올바르게 인식되고 실행된 비율
- 상호작용 시간: 작업 완료까지 걸린 시간 및 상호작용 횟수
- 학습 곡선: 시간에 따른 명령어 직접 사용 비율 증가
- 기능 발견: 사용자가 발견하고 사용한 기능의 범위

### 7.2 피드백 루프

- 사용 패턴 분석: 자주 사용되는 명령어 및 흐름 추적
- 오류 로깅: 인식 실패 및 명령어 오류 추적
- 사용자 피드백: 인터페이스 내 간단한 피드백 메커니즘 제공

### 7.3 개선 사이클

- 주간 개선: 피드백 기반 우선순위가 높은 이슈 해결
- 월간 리뷰: 사용 패턴 분석 및 주요 개선 영역 식별
- 분기별 업데이트: 주요 기능 및 UX 개선 릴리스

## 8. 결론

APE 하이브리드 인터페이스는 AI 어시스턴트의 자연스러운 상호작용과 도메인 특화 도구의 강력한 기능을 결합합니다. 이 설계는 사용자가 복잡한 명령어를 외울 필요 없이 필요한 기능을 직관적으로 발견하고 활용할 수 있게 하며, 점진적으로 더 효율적인 명령어 사용법을 학습할 수 있도록 지원합니다.

온프레미스 환경에 최적화된 도메인 중심 서비스라는 APE의 핵심 가치를 유지하면서, 모든 수준의 사용자가 즉시 생산성을 높일 수 있는 경험을 제공합니다. 이 접근법은 초보 사용자에게는 낮은 진입 장벽을, 숙련된 사용자에게는 효율성을 제공하는 균형 잡힌 솔루션입니다.