# APE 확장 프로그램 - 역할자 3(UI/UX) 작업 명세

## 역할 개요

역할자 3은 APE 확장 프로그램의 UI/UX 구현을 담당합니다. 명령어 시스템의 사용자 인터페이스 부분, 특히 웹뷰 기반 채팅 인터페이스와 명령어 자동완성 기능 구현에 중점을 둡니다.

## 현재 상황 분석

현재 진행 상황 문서를 기반으로 다음과 같은 UI 관련 작업이 진행 중입니다:

- ✅ Claude 스타일 CSS 구현: 모던하고 직관적인 채팅 인터페이스 디자인
- ✅ 개선된 코드 블록 처리: 구문 강조 및 복사 기능 구현
- ✅ 모델 선택기 컴포넌트: 제공자별 그룹화 및 직관적인 UI
- ✅ 메시지 스트리밍 지원: 자연스러운 응답 표시 기능
- ✅ 반응형 레이아웃: 다양한 화면 크기 지원
- ✅ 다크/라이트 테마 통합: VS Code 테마와 연동
- ✅ 웰컴 페이지 구현: 빈 채팅 상태 개선
- ✅ 명령어 자동완성 UI: 애니메이션, 색상 코딩, 개선된 검색 시스템 구현 완료
- ✅ TreeView 구현: 채팅, 명령어, 지식 저장소, 룰, 설정 등의 계층적 구조 구현 완료
- ⚠️ 명령어 패널 완성: 도메인별 명령어 그룹화 및 직관적 UI 개발 중

## 남은 작업 항목

### 1. 명령어 자동완성 UI 개선 (✅ 완료)

명령어 시스템의 핵심 UI 구성 요소인 자동완성 기능을 개선했습니다.

**구현된 기능:**
- ✅ CommandParserService.suggestSimilarCommands() 메서드와 연동하여 자동완성 기능 고도화
- ✅ 도메인 기반 명령어 구조에 맞는 자동완성 UI 구현
- ✅ 명령어 타입별(시스템, 에이전트) 시각적 구분 개선
- ✅ 명령어 자동완성 컴포넌트의 반응성 및 사용성 개선 
- ✅ 트리거 문자(`@`, `/`) 기반 자동 카테고리 표시 기능

**구현 내용:**
- `resources/css/command-autocomplete.css`: 애니메이션, 색상 코딩, 시각적 계층 구조 개선
- `resources/js/command-autocomplete.js`: 확장 검색 기능, 상호작용 개선
- 웹뷰에서 명령어 파서 및 레지스트리 서비스와 통신하는 인터페이스 개선

**추가 개선점:**
- 컨텍스트 인식 명령어 추천 시스템과 UI 통합

### 2. TreeView 구현 (✅ 완료)

VS Code의 TreeView API를 활용하여 APE의 주요 기능을 계층적으로 표시하는 UI를 구현했습니다.

**구현된 기능:**
- ✅ TreeDataProvider 인터페이스 구현 (`ApeTreeDataProvider` 클래스)
- ✅ 채팅, 명령어, 지식 저장소, 룰, 설정 등의 계층적 구조 구현
- ✅ 각 노드별 컨텍스트 메뉴 및 액션 정의
- ✅ VS Code 테마와 일관된 아이콘 및 시각적 요소 구현
- ✅ 명령어 세부정보 표시 기능

**구현 내용:**
- `src/ui/ApeTreeDataProvider.ts`: TreeView 데이터 제공자 구현
- `extension.ts`: TreeView 등록 및 명령어 핸들러 구현
- `package.json`: TreeView 및 명령어 등록
- `docs/APE_TREEVIEW_IMPLEMENTATION.md`: 구현 문서 작성

**추가 개선점:**
- 실제 데이터 연동 (현재는 샘플 데이터)
- 상태 저장 및 복원 (확장/축소 상태 등)
- 필터링 및 검색 기능

### 3. 명령어 패널 완성

명령어 그룹화 및 직관적 UI를 통해 사용자가 쉽게 명령어를 찾고 실행할 수 있는 패널이 필요합니다.

**작업 목록:**
- 도메인별 명령어 그룹화 UI 개선
- 명령어 패널 내 검색 기능 구현
- 자주 사용하는 명령어 핀 기능 추가
- 명령어 사용법 및 예제 보기 UI 구현
- 명령어 실행 결과 표시 방식 개선 (displayMode 필드 활용)

**접근 방법:**
- `resources/html/command-buttons.html` 및 관련 JS 파일 개선
- CommandRegistry.getAllDomainCommands() 메서드를 활용하여 도메인별 명령어 목록 가져오기
- 웹뷰-확장 프로그램 통신 최적화로 명령어 실행 응답성 개선

### 4. 명령어 결과 표시 방식 개선

CommandResult 인터페이스의 displayMode 필드를 활용하여 명령어 실행 결과를 적절한 형식으로 표시하는 기능이 필요합니다.

**작업 목록:**
- displayMode에 따른 결과 렌더링 방식 구현 (text, markdown, json, html, none)
- JSON 결과를 위한 접이식 뷰어 구현
- HTML 결과를 위한 안전한 렌더링 메커니즘 구현
- 마크다운 렌더링 개선 (이미 구현된 코드 블록 처리와 통합)

**접근 방법:**
- `resources/js/improved-ape-ui.js` 파일에 displayMode 처리 로직 추가
- ApeChatViewProvider에서 전달되는 결과 형식 분석 및 처리

### 5. 스트리밍 UI 응답성 개선

이미 구현된 스트리밍 기능의 UI 응답성을 더욱 개선합니다.

**작업 목록:**
- 스트리밍 중 타이핑 효과 부드럽게 개선
- 코드 블록 실시간 구문 강조 지원
- 스트리밍 중단 및 재개 UI 구현
- 스트리밍 진행률 표시 개선

**접근 방법:**
- 현재 구현된 스트리밍 로직 분석 및 최적화
- 실시간 마크다운 파싱 및 렌더링 개선

## 역할자 간 협업 사항

### 역할자 1(명령어 시스템)과의 협력 사항
- CommandResult 인터페이스의 displayMode 필드 활용 방안 협의
- 명령어 자동완성을 위한 CommandParserService.suggestSimilarCommands() 메서드 활용 방안 논의
- 명령어 그룹화 및 분류를 위한 CommandRegistry.getAllDomainCommands() 메서드 활용 방안 협의

### 역할자 2(도메인 서비스)와의 협력 사항
- 도메인별 명령어 형식 및 UI 표현 방식 협의
- 플러그인별 고유 UI 요소 지원 방안 논의
- 도메인별 결과 표시 방식 표준화

## 우선순위 및 로드맵

1. **높은 우선순위 (즉시 착수)**
   - ✅ 명령어 자동완성 UI 개선 (완료)
   - ⚠️ 명령어 패널 완성 (도메인별 그룹화)
   - ⚠️ 명령어 결과 표시 방식 개선 (displayMode 활용)

2. **중간 우선순위 (1-2주 내 착수)**
   - ✅ TreeView 구현 (완료)
   - ⚠️ 스트리밍 UI 응답성 개선
   - ✅ 테마 통합 완성 (완료)

3. **낮은 우선순위 (장기 과제)**
   - 고급 UI 애니메이션 및 전환 효과
   - 키보드 단축키 설정 UI
   - 접근성 개선 (스크린 리더 지원 등)

## 구현 가이드라인

1. **VS Code 디자인 언어 준수**
   - VS Code의 색상 변수 및 테마 시스템 활용
   - VS Code의 아이콘 세트(codicons) 일관되게 사용
   - VS Code UI 컴포넌트와 유사한 동작 및 모습 유지

2. **Claude 스타일 디자인 요소 통합**
   - 미니멀리즘: 불필요한 요소 제거, 핵심 기능에 집중
   - 직관성: 명확한 시각적 계층 구조와 의미
   - 응답성: 모든 디바이스 크기에서 최적화된 경험

3. **성능 고려사항**
   - 대규모 채팅 기록 처리 시 가상화 기법 적용
   - UI 렌더링 최적화 및 불필요한 리렌더링 방지
   - 비동기 작업 표시 및 결과 캐싱

## 결론

역할자 3은 APE 확장 프로그램의 UI/UX를 개선하여 사용자 경험을 최적화하는 역할을 담당합니다. 명령어 시스템과 도메인 서비스의 기능을 직관적이고 효율적으로 사용할 수 있는 인터페이스를 구현해야 합니다. 위의 작업 항목들을 우선순위에 따라 순차적으로 구현하며, 다른 역할자들과 긴밀히 협력하여 통합된 사용자 경험을 제공해야 합니다.